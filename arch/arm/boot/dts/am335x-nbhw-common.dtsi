/*
 * Copyright (C) 2012 Texas Instruments Incorporated - http://www.ti.com/
 *
 * This program is free software; you can redistribute it and/or modify
 * it under the terms of the GNU General Public License version 2 as
 * published by the Free Software Foundation.
 */

#include <dt-bindings/interrupt-controller/irq.h>
/ {
	cpus {
		cpu@0 {
			cpu0-supply = <&dcdc1>;
		};
	};

	memory {
		device_type = "memory";
		reg = <0x80000000 0x10000000>; /* 256 MB */
	};

	leds {
		pinctrl-names = "default";
		pinctrl-0 = <&user_leds_s0>;

		compatible = "gpio-leds";

		led@1 {
			label = "nb:green:leda";
			gpios = <&gpio1 14 GPIO_ACTIVE_HIGH>;
			default-state = "off";
		};

		led@2 {
			label = "nb:green:ledb";
			gpios = <&gpio1 15 GPIO_ACTIVE_HIGH>;
			default-state = "on";
		};
	};

	gpio_keys: gpio-keys {
		pinctrl-names = "default";
		pinctrl-0 = <&user_buttons_s0>;

		compatible = "gpio-keys";

		reset_button: reset-button {
			label = "Reset button";
			gpios = <&gpio1 13 GPIO_ACTIVE_LOW>;
			linux,code = <0x198>; /* KEY_RESTART */
		};
	};


	wlan_fixed: fixedregulator@0 {
		compatible = "regulator-fixed";
		regulator-name = "wlan_fixed";
		regulator-min-microvolt = <1800000>;
		regulator-max-microvolt = <1800000>;

		startup-delay-us = <700000>;
		enable-active-high;
	};

	vmmcsd_fixed: fixedregulator@1 {
		compatible = "regulator-fixed";
		regulator-name = "vmmcsd_fixed";
		regulator-min-microvolt = <1800000>;
		regulator-max-microvolt = <1800000>;
	};

	gsm_codec: gtm601_codec {
		compatible = "option,gtm601";
		#sound-dai-cells = <0>;
	};

	sound {
		compatible = "simple-audio-card";
		simple-audio-card,name = "AM335x-GSM";
		simple-audio-card,bitclock-master = <&sound_master>;
		simple-audio-card,frame-master = <&sound_master>;
		simple-audio-card,format = "i2s";

		simple-audio-card,cpu {
			sound-dai = <&mcasp0>;
		};

		sound_master: simple-audio-card,codec {
			sound-dai = <&gsm_codec>;
		};
	};
};

&epwmss0 {
	status = "okay";

	ecap0: ecap@48300100 {
		status = "okay";
		pinctrl-names = "default";
		pinctrl-0 = <&ecap0_pins>;
	};
};

&uart0 {
	pinctrl-names = "default";
	pinctrl-0 = <&uart0_pins>;

	status = "okay";
};

&uart5 {
	pinctrl-names = "default";
	pinctrl-0 = <&bt_uart_pins>;

	status = "okay";
};

&usb {
	status = "okay";
};

&usb_ctrl_mod {
	status = "okay";
};

&usb0_phy {
	pinctrl-names = "default";
	pinctrl-0 =  <&usb_gsm_pins>;
	status = "okay";
};

&usb1_phy {
	pinctrl-names = "default";
	pinctrl-0 =  <&usb_expansion_pins>;
	status = "okay";
};

&usb0 {
	status = "okay";
	dr_mode = "host";
};

&usb1 {
	status = "okay";
	dr_mode = "host";
};

&cppi41dma  {
	status = "okay";
};

&i2c0 {
	pinctrl-names = "default";
	pinctrl-0 = <&i2c0_pins>;

	status = "okay";
	clock-frequency = <100000>;

	eeprom: at24@50 {
		compatible = "at24,24c64";
		pagesize = <8>;
		reg = <0x50>;
	};

	tps65218: tps65218@24 {
		reg = <0x24>;
		compatible = "ti,tps65218";
		interrupt-parent = <&intc>;
		interrupts = <7>;	/* NNMI */
		#interrupt-cells = <2>;

		dcdc1: regulator-dcdc1 {
			compatible = "ti,tps65218-dcdc1";
			regulator-name = "vdd_core";
			regulator-min-microvolt = <1100000>;
			regulator-max-microvolt = <1100000>;
			regulator-boot-on;
			regulator-always-on;
		};

		dcdc2: regulator-dcdc2 {
			compatible = "ti,tps65218-dcdc2";
			regulator-name = "vdd_mpu";
			regulator-min-microvolt = <1100000>;
			regulator-max-microvolt = <1100000>;
			regulator-boot-on;
			regulator-always-on;
		};

		dcdc3: regulator-dcdc3 {
			compatible = "ti,tps65218-dcdc3";
			regulator-name = "vdd_ddr";
			regulator-min-microvolt = <1500000>;
			regulator-max-microvolt = <1500000>;
			regulator-boot-on;
			regulator-always-on;
		};

		dcdc4: regulator-dcdc4 {
			compatible = "ti,tps65218-dcdc4";
			regulator-name = "v3_3d";
			regulator-min-microvolt = <3300000>;
			regulator-max-microvolt = <3300000>;
			regulator-boot-on;
			regulator-always-on;
		};

		ldo1: regulator-ldo1 {
			compatible = "ti,tps65218-ldo1";
			regulator-min-microvolt = <1800000>;
			regulator-max-microvolt = <1800000>;
			regulator-boot-on;
			regulator-always-on;
		};
	};
};

&mcasp0 {
	#sound-dai-cells = <0>;
	pinctrl-names = "default", "sleep";
	pinctrl-0 = <&pcm_pins>;
	pinctrl-1 = <&pcm_pins>;

	status = "disabled";

	op-mode = <1>;		  /* S/PDIF */
	tdm-slots = <1>;
	/* 4 serializers */
	serial-dir = <  /* 0: INACTIVE, 1: TX, 2: RX */
		1 2 0 0
	>;
	tx-num-evt = <32>;
	rx-num-evt = <32>;
};

&cpsw_emac0 {
	phy_id = <&davinci_mdio>, <0>;
	phy-mode = "rmii";
};

&cpsw_emac1 {
	phy_id = <&davinci_mdio>, <1>;
	phy-mode = "rmii";
};

&phy_sel {
	rmii-clock-ext;
};

&mac {
	pinctrl-names = "default", "sleep";
	pinctrl-0 = <&cpsw_default>;
	pinctrl-1 = <&cpsw_sleep>;
	status = "okay";
};

&davinci_mdio {
	pinctrl-names = "default", "sleep";
	pinctrl-0 = <&davinci_mdio_default>;
	pinctrl-1 = <&davinci_mdio_sleep>;
	bus_freq = <2000000>;
	status = "okay";
};

&mmc1 {
	status = "okay";
	pinctrl-names = "default";
	pinctrl-0 = <&sdio_wlan_pins>;
	bus-width = <0x4>;
	vmmc-supply = <&wlan_fixed>;
	non-removable;
	ti,non-removable;
	keep-power-in-suspend;

	#address-cells = <1>;
	#size-cells = <0>;
	wlcore: wlcore@2 {
		status = "okay";
		compatible = "ti,wl1835";
		reg = <2>;
		interrupt-parent = <&gpio3>;
		interrupts = <9 IRQ_TYPE_LEVEL_HIGH>;
	};

};

&mmc2 {
	vmmc-supply = <&vmmcsd_fixed>;
	pinctrl-names = "default";
	pinctrl-0 = <&emmc_pins>;
	bus-width = <8>;
	status = "okay";
};

&rtc {
	ti,hwmod-disabled;
	status = "disabled";
};

&wdt2 {
	ti,hwmod-disabled;
	status = "disabled";
};

// We dont want to lose the gpio state that was set in u-boot
&gpio0 {
	ti,gpio-always-on;
	ti,no-reset-on-init;
	ti,no-idle-on-init;
};

&gpio1 {
	ti,gpio-always-on;
	ti,no-reset-on-init;
	ti,no-idle-on-init;
};

&gpio2 {
	ti,gpio-always-on;
	ti,no-reset-on-init;
	ti,no-idle-on-init;
};

&gpio3 {
	ti,gpio-always-on;
	ti,no-reset-on-init;
	ti,no-idle-on-init;
};

